<div class="home-container">
  <div class="header-section">
    <h2>Welcome to Health Companion</h2>
    <div class="header-actions">
      <button
        class="profile-btn"
        routerLink="/onboarding/demographics"
        title="Edit Profile"
      >
        üë§ Profile
      </button>
      <button
        class="settings-btn"
        routerLink="/settings/security"
        title="Security Settings"
      >
        ‚öôÔ∏è Security
      </button>
    </div>
  </div>

  <div class="status-section">
    <h3>API Status Check</h3>
    <div
      class="status-indicator"
      [ngClass]="{
        success: apiStatus === 'ok',
        error: apiStatus === 'error',
        loading: apiStatus === 'loading'
      }"
    >
      <span>Status: {{ apiStatusMessage }}</span>
    </div>
    <button (click)="checkApiHealth()" [disabled]="apiStatus === 'loading'">
      {{ apiStatus === "loading" ? "Checking..." : "Check API Health" }}
    </button>
  </div>

  <div class="navigation-section">
    <h3>App Modules</h3>
    <div class="module-grid">
      <button class="module-btn nutrition" routerLink="/nutrition">
        <div class="icon">üçé</div>
        <span>Nutrition</span>
        <small>Track meals with photos</small>
      </button>
      <button class="module-btn biometrics" routerLink="/biometrics/weight">
        <div class="icon">üìä</div>
        <span>Weight Log</span>
        <small>Track daily weight</small>
      </button>
      <button class="module-btn biometrics" routerLink="/biometrics/bp-hr">
        <div class="icon">üíì</div>
        <span>BP & Heart Rate</span>
        <small>Blood pressure & HR</small>
      </button>
      <button class="module-btn biometrics" routerLink="/biometrics/pain">
        <div class="icon">ü©π</div>
        <span>Pain Log</span>
        <small>Track pain levels</small>
      </button>
      <button
        class="module-btn biometrics"
        routerLink="/biometrics/mood-energy"
      >
        <div class="icon">üòä</div>
        <span>Mood & Energy</span>
        <small>Track mood & energy</small>
      </button>
      <button class="module-btn dashboard" disabled>
        <div class="icon">üìà</div>
        <span>Dashboard</span>
        <small>Coming soon</small>
      </button>
      <button class="module-btn companion" disabled>
        <div class="icon">ü§ñ</div>
        <span>AI Companion</span>
        <small>Coming soon</small>
      </button>
    </div>
  </div>

  <!-- Latest Weight Display -->
  <div class="weight-section" *ngIf="apiStatus === 'ok'">
    <div class="section-header">
      <h3>Latest Weight</h3>
      <div class="action-buttons">
        <button class="quick-action-btn" routerLink="/biometrics/weight">
          + Weight
        </button>
        <button class="quick-action-btn" routerLink="/biometrics/bp-hr">
          + BP/HR
        </button>
        <button class="quick-action-btn" routerLink="/biometrics/pain">
          + Pain
        </button>
        <button class="quick-action-btn" routerLink="/biometrics/mood-energy">
          + Mood/Energy
        </button>
      </div>
    </div>

    <div class="weight-card" *ngIf="latestWeight; else noWeight">
      <div class="weight-value">
        <span class="value">{{ latestWeight.valueKg }}</span>
        <span class="unit">kg</span>
      </div>
      <div class="weight-meta">
        <span class="date">{{ latestWeight.takenAt | date : "short" }}</span>
      </div>
    </div>

    <ng-template #noWeight>
      <div class="no-weight-card">
        <p>No weight entries yet</p>
        <button class="btn-primary" routerLink="/biometrics/weight">
          Log First Weight
        </button>
      </div>
    </ng-template>
  </div>

  <div class="sdk-demo-section" *ngIf="apiStatus === 'ok'">
    <h3>SDK Demo - Daily Summary</h3>
    <div *ngIf="dailySummary" class="summary-card">
      <h4>Daily Summary for {{ dailySummary.date }}</h4>
      <div class="summary-stats">
        <div class="stat">
          <label>Completion Score:</label>
          <span>{{ dailySummary.completionScore }}%</span>
        </div>
        <div class="stat" *ngIf="dailySummary.nutrition">
          <label>Calories:</label>
          <span
            >{{ dailySummary.nutrition.totalCalories }} /
            {{ dailySummary.nutrition.goalCalories }}</span
          >
        </div>
        <div class="stat" *ngIf="dailySummary.hydration">
          <label>Hydration:</label>
          <span
            >{{ dailySummary.hydration.totalMl }}ml /
            {{ dailySummary.hydration.goalMl }}ml ({{
              dailySummary.hydration.percentage
            }}%)</span
          >
        </div>
        <div class="stat" *ngIf="dailySummary.weight">
          <label>Weight:</label>
          <span
            >{{ dailySummary.weight.weightKg }}kg ({{
              dailySummary.weight.trend
            }})</span
          >
        </div>
        <div class="stat" *ngIf="latestBP && isTodayData(latestBP.takenAt)">
          <label>Blood Pressure:</label>
          <span>{{ latestBP.systolic }}/{{ latestBP.diastolic }} mmHg</span>
        </div>
        <div class="stat" *ngIf="latestHR && isTodayData(latestHR.takenAt)">
          <label>Resting HR:</label>
          <span>{{ latestHR.bpm }} bpm</span>
        </div>
        <div class="stat" *ngIf="latestPain && isTodayData(latestPain.takenAt)">
          <label>Pain:</label>
          <span
            >{{ latestPain.score }}/10 ({{
              latestPain.location.replace("_", " ") | titlecase
            }})</span
          >
        </div>
        <div class="stat" *ngIf="latestMood && isTodayData(latestMood.takenAt)">
          <label>Mood:</label>
          <span>{{ latestMood.mood }}</span>
        </div>
        <div
          class="stat"
          *ngIf="latestEnergy && isTodayData(latestEnergy.takenAt)"
        >
          <label>Energy:</label>
          <span>{{ latestEnergy.score }}/10</span>
        </div>
      </div>
    </div>

    <h3>SDK Demo - AI Companion Message</h3>
    <div *ngIf="companionMessage" class="companion-card">
      <h4>
        {{ companionMessage.type | titlecase }} -
        {{ companionMessage.tone | titlecase }}
      </h4>
      <p>{{ companionMessage.message }}</p>
      <div class="metadata" *ngIf="companionMessage.metadata">
        <small>
          Nutrition Score: {{ companionMessage.metadata.nutritionScore }}% |
          Hydration Score: {{ companionMessage.metadata.hydrationScore }}%
        </small>
        <div class="insights" *ngIf="companionMessage.metadata.keyInsights">
          <strong>Key Insights:</strong>
          <ul>
            <li *ngFor="let insight of companionMessage.metadata.keyInsights">
              {{ insight }}
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>
